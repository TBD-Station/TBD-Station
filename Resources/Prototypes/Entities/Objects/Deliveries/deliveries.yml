- type: entity
  abstract: true
  parent: BaseItem
  id: BaseDelivery
  components:
  - type: FingerprintReader
    failPopup: fingerprint-reader-fail
    failGlovesPopup: fingerprint-reader-fail-gloves
  - type: Delivery
    openSound:
      path: /Audio/Effects/unwrap.ogg
    unlockSound:
      path: /Audio/Effects/Cargo/ping.ogg
      params:
        volume: -10

- type: entity # TODO: Move this to a different file, also make this like a proper machine
  id: CargoMailPad
  parent: BaseMachinePowered
  name: mail telepad
  description: Beam in the pizzas and dig in.
  components:
  - type: InteractionOutline
  - type: Physics
    bodyType: Static
    canCollide: false
  - type: Transform
    anchored: true
    noRot: true
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "-0.45,-0.45,0.45,0.00"
        density: 190
        mask:
        - MachineMask
  - type: Sprite
    sprite: Structures/cargo_telepad.rsi
    drawdepth: HighFloorObjects
    layers:
    - state: offline
      map: [ "enum.CargoTelepadLayers.Base" ]
    - state: idle
      map: [ "enum.CargoTelepadLayers.Beam" ]
      shader: unshaded
  - type: Damageable
    damageContainer: StructuralInorganic
    damageModifierSet: StructuralMetallicStrong
  - type: ApcPowerReceiver
    powerLoad: 1000
  - type: Appearance
  - type: CollideOnAnchor
  - type: NameIdentifier
    group: CargoTelepads
  - type: PowerSwitch
  - type: DeliverySpawner
    table: !type:NestedSelector
      tableId: RandomDeliveryBasic

- type: entityTable # TODO: Move to a seperate file, make these actual entity tables people can expand on
  id: RandomDeliveryBasic
  table: !type:GroupSelector
    children:
    - id: LetterDelivery
      weight: 0.7
    - id: PackageDelivery
      weight: 0.3

- type: entity
  parent: BaseDelivery
  id: PackageDelivery
  name: package
  components:
  - type: Sprite
    sprite: Objects/Storage/boxes.rsi
    state: box
  - type: Delivery
    spesoReward: 1000
    wrapper: MaterialCardboard1
  - type: SpawnTableOnUse
    table: !type:NestedSelector
      tableId: RandomTechBoardTable

- type: entity
  parent: BaseDelivery
  id: LetterDelivery
  name: letter
  components:
  - type: Sprite
    sprite: Objects/Specific/Cargo/mail.rsi
    layers:
    - state: icon
      map: [ "enum.DeliveryVisualLayers.Icon" ]
    - state: postmark
    - map: [ "enum.DeliveryVisualLayers.JobStamp" ]
      scale: 0.8, 0.8
      offset: 0.225, 0.165
    - state: fragile
      map: [ "enum.DeliveryVisualLayers.FragileStamp" ]
      visible: false
    - state: locked
      map: [ "enum.DeliveryVisualLayers.Lock" ]
    - state: priority
      map: [ "enum.DeliveryVisualLayers.PriorityTape" ]
      visible: false
      shader: unshaded
    - state: broken
      map: [ "enum.DeliveryVisualLayers.Breakage" ]
      visible: false
  - type: Appearance
  - type: GenericVisualizer
    visuals:
      enum.DeliveryVisuals.IsFragile:
        enum.DeliveryVisualLayers.FragileStamp:
          True:
            visible: true
          False:
            visible: false
      enum.DeliveryVisuals.IsLocked:
        enum.DeliveryVisualLayers.Lock:
          True:
            visible: true
          False:
            visible: false
      enum.DeliveryVisuals.IsPriority:
        enum.DeliveryVisualLayers.PriorityTape:
          True:
            visible: true
          False:
            visible: false
      enum.DeliveryVisuals.IsPriorityInactive:
        enum.DeliveryVisualLayers.PriorityTape:
          True:
            shader: shaded
            state: priority_inactive
          False:
            shader: unshaded
            state: priority
      enum.DeliveryVisuals.IsBroken:
        enum.DeliveryVisualLayers.Breakage:
          True:
            visible: true
          False:
            visible: false
      enum.DeliveryVisuals.IsTrash:
        enum.DeliveryVisualLayers.Icon:
          True:
            state: trash
          False:
            state: icon
  - type: Delivery
    spesoReward: 500
    wrapper: PaperScrap
  - type: SpawnTableOnUse
    table: !type:NestedSelector
      tableId: RandomTechBoardTable
